Index: Sprite.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import random, arcade, csv\r\n\r\ndef convert(val):\r\n    try:\r\n        return float(val)\r\n    except ValueError:\r\n        return val\r\n\r\nwith open(\"SETTINGS/EnvVars.csv\", \"r\") as f:\r\n    ENV_VAR_DICT = {key: convert(val) for key, val in csv.reader(f)}\r\n\r\ndef cords_to_pixels(cords):\r\n    return tuple([cord * ENV_VAR_DICT[\"TILE_SIZE\"] + ENV_VAR_DICT[\"TILE_SIZE\"] // 2 for cord in cords])\r\n\r\n\r\nKEY_CONFIG = {\r\n    arcade.key.UP: (-1, 0, 1),\r\n    arcade.key.DOWN: (1, 0, -1),\r\n    arcade.key.LEFT: (2, -1, 0),\r\n    arcade.key.RIGHT:(0, 1, 0)\r\n}\r\n\r\nclass Sprite(arcade.Sprite):\r\n    def __init__(self, type, cords, texture, delta = None, speed = 0, angle = 0, scale = 1):\r\n        self.type = type\r\n        x, y =cords\r\n        super().__init__(f\"img/{texture}.png\", scale, x,y)\r\n        self.angl = angle\r\n        self.speed = speed\r\n        if \"ghost\" in type:\r\n            self.is_eatable = False\r\n            self.alt_texture = \"img/GHOST_ALT.png\"\r\n        if delta:\r\n            self.delta_time = delta\r\n        self.m_x = self.center_x // ENV_VAR_DICT[\"TILE_SIZE\"]\r\n        self.m_y = self.center_y // ENV_VAR_DICT[\"TILE_SIZE\"]\r\n        self.key = None\r\n        self.timer=0\r\n        if type == \"cherry\":\r\n            self.points = 100\r\n        if type == \"coin\":\r\n            self.points = 10\r\n\r\n    def update_cherry(self):\r\n        if self.points == 100:\r\n            self.points = 0\r\n            self.texture = arcade.load_texture(\"img/BLANK_TEXTURE.png\")\r\n        else:\r\n            self.points = 100\r\n            self.texture = arcade.load_texture(\"img/CHERRY_TEXTURE.png\")\r\n\r\n\r\n    def ghost_update(self):\r\n        if self.is_eatable:\r\n            self.texture = arcade.load_texture(\"img/GHOST_ALT.png\")\r\n        else:\r\n            self.texture = arcade.load_texture(f\"img/{self.type.upper()}_TEXTURE.png\")\r\n\r\n        if self.delta_time == self.timer:\r\n            self.key = random.choice([arcade.key.UP,\r\n                                      arcade.key.DOWN,\r\n                                      arcade.key.LEFT,\r\n                                      arcade.key.RIGHT])\r\n            self.timer = 0\r\n        self.timer += 1\r\n\r\n    def update(self, delta_time=random.randrange(1,59)/60, *args, **kwargs):\r\n        if \"ghost\" in self.type:\r\n            self.ghost_update()\r\n\r\n        if self.center_x % 32 - 16 == 0 and self.center_y % 32 - 16 == 0:\r\n            if self.key:\r\n                self.move()\r\n            else:\r\n                self.stop()\r\n        self.m_x , self.m_y = self.center_x//ENV_VAR_DICT[\"TILE_SIZE\"], self.center_y//ENV_VAR_DICT[\"TILE_SIZE\"]\r\n        super().update()\r\n\r\n    def move(self):\r\n        if self.key in KEY_CONFIG:\r\n            self.angle, self.change_x, self.change_y =tuple(\r\n                x * y for x, y in zip(\r\n                    (self.angl, self.speed, self.speed),\r\n                    KEY_CONFIG[self.key]\r\n                )\r\n            )\r\n\r\n    def stop(self):\r\n        if self.center_x % (ENV_VAR_DICT[\"TILE_SIZE\"]//2) == 0 and self.center_y %(ENV_VAR_DICT[\"TILE_SIZE\"]//2) == 0:\r\n            self.key = None\r\n            super().stop()\r\n\r\n    def teleport(self, portal):\r\n        if portal.delta_time:\r\n            self.delta_time = portal.delta_time\r\n            self.center_x = portal.center_x\r\n            self.center_y = portal.center_y\r\n            portal.delta_time = False\r\n\r\ndef sprite(emoji, cords):\r\n    types = {\"⬜\": lambda crds: Sprite(\"coin\", cords, \"COIN_TEXTURE\"),\r\n             \"⬛\": lambda crds: Sprite(\"wall\", cords, \"WALL_TEXTURE\"),\r\n             \"\uD83D\uDE10\": lambda crds: Sprite(\"pacman\", cords, \"PACMAN_TEXTURE\", None, 4, 90),\r\n             \"\uD83D\uDE21\": lambda crds: Sprite(\"r_ghost\", cords, \"R_GHOST_TEXTURE\", 100, 4),\r\n             \"⭐\": lambda crds: Sprite(\"y_ghost\", cords, \"Y_GHOST_TEXTURE\", 120, 4),\r\n             \"\uD83D\uDCD8\": lambda crds: Sprite(\"b_ghost\", cords, \"B_GHOST_TEXTURE\", 110, 4),\r\n             \"\uD83D\uDE08\": lambda crds: Sprite(\"p_ghost\", cords, \"P_GHOST_TEXTURE\", 130, 4),\r\n             \"\uD83C\uDF4E\": lambda crds: Sprite(\"powerup\", cords, \"COIN_TEXTURE\"),\r\n             \"\uD83D\uDC9B\": lambda crds: Sprite(\"teleport\", cords, \"PACMAN_TEXTURE\", True),\r\n             \"\uD83C\uDF52\": lambda crds: Sprite(\"cherry\", cords, \"CHERRY_TEXTURE\"),}\r\n    return types[emoji](cords)\r\n\r\ndef load_level_from_txt():\r\n    with open(\"SETTINGS/level.txt\", \"r\", encoding=\"utf-8\") as file:\r\n        return [[sprite(emoji, cords_to_pixels((posx, posy))) for posx, emoji in enumerate(row.strip())] for posy, row in\r\n                enumerate(file.readlines())]\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Sprite.py b/Sprite.py
--- a/Sprite.py	(revision bd04bcb5534d43d94fa8e398a44f7bbc8bd9df22)
+++ b/Sprite.py	(date 1770668330213)
@@ -41,7 +41,7 @@
         if type == "coin":
             self.points = 10
 
-    def update_cherry(self):
+    def update_cherry(self, score):
         if self.points == 100:
             self.points = 0
             self.texture = arcade.load_texture("img/BLANK_TEXTURE.png")
Index: main.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from Sprite import *\r\n\r\nclass PacmanGame(arcade.View):\r\n    def __init__(self, level_matrix, w_s_x=0, w_s_y=0):\r\n        super().__init__()\r\n        self.w, self.h = w_s_x, w_s_y\r\n        self.score = 0\r\n        self.score_text = None\r\n        self.game_over = False\r\n\r\n        self.music = arcade.load_sound(\"music/pacman_back.mp3\")\r\n\r\n        self.level_matrix = level_matrix\r\n        self.eat_timer = 0\r\n\r\n        self.coin = arcade.SpriteList()\r\n        self.ghost = arcade.SpriteList()\r\n        self.move = arcade.SpriteList()\r\n        self.wall = arcade.SpriteList()\r\n        self.teleport = arcade.SpriteList()\r\n        self.cherry = arcade.SpriteList()\r\n        self.powerup = arcade.SpriteList()\r\n        self.pacman = None\r\n        arcade.set_background_color(arcade.color.BLACK)\r\n\r\n    def on_key_press(self, key, modifiers):\r\n        if not self.game_over:\r\n            self.pacman.key = key\r\n\r\n    def append(self, sprite):\r\n        type = sprite.type\r\n        if \"pacman\" in type:\r\n            self.pacman = sprite\r\n            type = \"move\"\r\n        if \"ghost\" in type:\r\n            self.ghost.append(sprite)\r\n            type = \"move\"\r\n        getattr(self, type).append(sprite)\r\n\r\n    def update(self):\r\n        for list_type in [\"wall\", \"coin\", \"move\", \"cherry\", \"powerup\", \"teleport\"]:\r\n            getattr(self, list_type).update()\r\n\r\n    def stop(self):\r\n        for list_type in [\"wall\", \"coin\", \"move\", \"cherry\", \"powerup\", \"teleport\"]:\r\n            for item in getattr(self, list_type):\r\n                item.stop()\r\n\r\n    def draw(self):\r\n        for list_type in [\"wall\", \"coin\", \"move\", \"cherry\", \"powerup\", \"teleport\"]:\r\n            getattr(self, list_type).draw()\r\n\r\n    def setup(self):\r\n        self.music.play(volume=0.2, loop=True)\r\n        for row in self.level_matrix:\r\n            for item in row:\r\n                self.append(item)\r\n\r\n    def on_draw(self):\r\n        self.clear()\r\n        self.draw()\r\n        arcade.Text(f\"Score: {self.score}\",\r\n                    ENV_VAR_DICT['TILE_SIZE'] + 2,\r\n                    ENV_VAR_DICT['TILE_SIZE'] // 3,\r\n                    arcade.color.YELLOW,\r\n                    ENV_VAR_DICT['TILE_SIZE'] // 2).draw()\r\n\r\n        if self.game_over:\r\n            arcade.Text(\"YOU WIN\" if not self.coin else \"YOU LOST\",\r\n                        self.w // 2,\r\n                        self.h // 2,\r\n                        arcade.color.GREEN if not self.coin else arcade.color.RED,\r\n                        50,\r\n                        anchor_x=\"center\").draw()\r\n\r\n    def on_update(self, delta_time):\r\n        self.update()\r\n        for item in self.move:\r\n            if arcade.check_for_collision_with_list(item, self.wall):\r\n                item.center_x = item.m_x * ENV_VAR_DICT['TILE_SIZE'] + ENV_VAR_DICT['TILE_SIZE'] // 2\r\n                item.center_y = item.m_y * ENV_VAR_DICT['TILE_SIZE'] + ENV_VAR_DICT['TILE_SIZE'] // 2\r\n                item.stop()\r\n            if self.teleport[0].delta_time and arcade.check_for_collision(item, self.teleport[0]):\r\n                self.pacman.teleport(self.teleport[1])\r\n            if self.teleport[1].delta_time and arcade.check_for_collision(item, self.teleport[1]):\r\n                self.pacman.teleport(self.teleport[0])\r\n            if not arcade.check_for_collision_with_list(item, self.teleport):\r\n                for i in self.teleport:\r\n                    i.delta_time = True\r\n\r\n        coin_hit = arcade.check_for_collision_with_list(self.pacman, self.coin)\r\n        for coin in coin_hit:\r\n            arcade.play_sound(arcade.load_sound(\"music/coin.mp3\"), volume=0.2)\r\n            coin.remove_from_sprite_lists()\r\n            self.score += 1\r\n\r\n\r\n\r\n\r\n\r\n        if not self.coin or arcade.check_for_collision_with_list(self.pacman, self.ghost):\r\n            self.stop()\r\n\r\n            self.game_over = True\r\n\r\n\r\n\r\ndef main():\r\n    level_matrix = load_level_from_txt()\r\n    w_s_x,w_s_y = len(level_matrix[0])*ENV_VAR_DICT['TILE_SIZE'], len(level_matrix)*ENV_VAR_DICT['TILE_SIZE']\r\n    window = arcade.Window(w_s_x, w_s_y, \"PACMAN GAME\", resizable=True)\r\n    game = PacmanGame(level_matrix, w_s_x, w_s_y)\r\n    game.setup()\r\n    window.show_view(game)\r\n    arcade.run()\r\n\r\nif __name__ == \"__main__\":\r\n    main()
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.py b/main.py
--- a/main.py	(revision bd04bcb5534d43d94fa8e398a44f7bbc8bd9df22)
+++ b/main.py	(date 1770668330229)
@@ -88,12 +88,15 @@
                 for i in self.teleport:
                     i.delta_time = True
 
-        coin_hit = arcade.check_for_collision_with_list(self.pacman, self.coin)
+        coin_hit = arcade.check_for_collision_with_lists(self.pacman, self.coin, self.cherry)
         for coin in coin_hit:
             arcade.play_sound(arcade.load_sound("music/coin.mp3"), volume=0.2)
             coin.remove_from_sprite_lists()
-            self.score += 1
+            self.score += coin.points
 
+        if self.score%70 == 0:
+            for i in self.cherry:
+                i.update_cherry()
 
 
 
